{
    "contents" : "---\ntitle: \"Funkcje, estymatory i twierdzenia graniczne\"\nauthor: \"A. M. Machno\"\ndate: \"2 października 2015\"\noutput: html_document\n---\n\n##Tworzenie funkcji\n\nJak zauważyliśmy wcześniej odchylenie standardowe może być liczone na dwa sposoby.\n\n```{r}\ndata(mtcars)\nattach(mtcars)\n\n#wbudowana funkcja\nsd(wt)\n\n#ręcznie\nsqrt(mean((wt-mean(wt))^2))\n```\n\nWyniki różnią się ze względu na mianownik w ułamku pod pierwiastkiem. Jako, że my używamy drugiego sposobu, chcielibyśmy więc funkcję, która liczy dokładnie w ten sposób. \n\n```{r}\n#funkcja licząca odchylenie standardowe z n w mianowniku\n\nsd.1<-function(x){\n      #śednia x\n      mean.x<-mean(x)\n      \n      #odchylenia od śreniej x\n      x.dev<-x-mean.x\n      \n      #kwadrat odchyleń od średniej\n      sq.dev<-x.dev^2\n      \n      #średnia kwadratów odchyleń\n      mean.sq<-mean(sq.dev)\n      \n      #wynik\n      sqrt(mean.sq)\n}\n\nsd.1(wt)\n```\n\nZauważmy, że ostatnia linia w funkcji jest nie przypisywana juz do żadnej zmiennej, jest to ostateczny wynik, który jest zwracany po wywołaniu funkcji. Zmienne wewnątrz funkcji nie sa przechowywane w pamięci podręcznej.\n\n```{r}\nls()\n```\n\n##Metoda największej wiarygodności\nZałóżmy, że zmienna `mpg` (*miles per gallon*) w zbiorze `mtcars` ma rozkład normalny z odchyleniem standardowym 6 i nieznaną średnią. Zbudujemy funkcję wiarygodności dla tego zagadnienia.\n\n```{r}\n\n#funkcja log-wiarygodności dla średniej w zmiennej mpg i odchylenia standardowego 6\n#jedynym argumentem jest średnia rozkładu\nmax.loglik.mpg<-function(mean.mpg){\n      data(mtcars)\n      mpg<-mtcars$mpg\n      sd.mpg<-6\n      #wektor gęstości\n      d.vec<-dnorm(mpg, mean.mpg, sd.mpg)\n      \n      #log-wiarygodność\n      sum(log(d.vec))\n}\n```\n\nNarysujemy wykres log-wiarygodności od wartości średniej (z dokładnością do 0.01).\n\n```{r, cache=T}\n#przedział w jakim badamy to (10,30)\npoints.lik<-seq(10,30,by=.01)\nlik.points<-rep(NA,length(points.lik))\n\nfor (i in 1:length(points.lik)) lik.points[i]<-max.loglik.mpg(points.lik[i])\n\nplot(points.lik, lik.points, t='l', \n     xlab=\"średnia\", ylab=\"log-wiarygodność\")\n\n#maksymalna wartość wiarygodności i odpowiadająca jej średni\nmax(lik.points); points.lik[lik.points==max(lik.points)]\n```\n\nDla wizualizacji działania estymacji metodą największej wiarygodności, zapraszam na stronę. [link](https://amachno.shinyapps.io/ML_mtcars_mpg)\n\n##Prawo wielkich liczb\n\nŚrednia z niezależnych obserwacji realizacji zmiennych losowych o tym samym rozkładzie wraz ze wzrostem liczebności próby jest bliższa teoretycznej zmiennej rozkładu. Na poniższych wykresach zaprezentowane są 4 wizualizacje tego zjawiska. Wykresy przedstawiaja zmiany średniej z próby wraz ze wzrostem liczebności próby.\n\n```{r, cache=T}\nset.seed(121)\n#konstruujemy 10 000 elementowe próby\n#rozkład standardowy normalny, teoretyczna średnia to 0\nx_snorm<-rnorm(10^4); snorm_mean<-0\n#rozkład wykladniczy z labda 1/10, teoretyczna średnia to 10\nx_exp<-rexp(10^4,1/10); exp_mean<-10\n#rzut symetryczną monetą, prawdopodobieństwo 1 równe prawdopodobieństwo 0 równe 50%. Teoretyczna średnia to oczywiście 1/2\nx_coin<-rbinom(10^4, 1, .5); coin_mean<-.5\n#rzut niesprawiedliwą monetą, gdzie wypadnięcie orła 1 to 90%, teoretyczna średnia to 0.9.\nx_bcoin<-rbinom(10^4,1,.9); bcoin_mean<-.9\n\n#tworzymy wektory średnich, gdzie i-ty element wektora to średnia i pierwszych obserwacji\nsnorm_means<-rep(NA, 10^4)\nexp_means<-rep(NA, 10^4)\ncoin_means<-rep(NA, 10^4)\nbcoin_means<-rep(NA, 10^4)\nfor(i in 1:10^4) snorm_means[i]<-mean(x_snorm[1:i])\nfor(i in 1:10^4) exp_means[i]<-mean(x_exp[1:i])\nfor(i in 1:10^4) coin_means[i]<-mean(x_coin[1:i])\nfor(i in 1:10^4) bcoin_means[i]<-mean(x_bcoin[1:i])\n```\n\n```{r}\n#ustalamy parametr wykresu, aby były 2x2 jako jeden obraz\npar(mfrow=c(2,2))\n#tworzymy wszystkie 4 wykresy z liniami odpowiadającymi teoretycznym średnim\nplot(snorm_means, t=\"l\", \n     main=\"Rozkład normalny\", xlab=\"Liczba obserwacji\", ylab=\"średnia\")\nabline(h=snorm_mean)\nplot(exp_means, t=\"l\", \n     main=\"Rozkład wykładniczy\", xlab=\"Liczba obserwacji\", ylab=\"średnia\")\nabline(h=exp_mean)\nplot(coin_means, t=\"l\", \n     main=\"Rzut symetryczną monetą\", xlab=\"Liczba obserwacji\", ylab=\"średnia\")\nabline(h=coin_mean)\nplot(bcoin_means, t=\"l\", \n     main=\"Rzut asymetryczną monetą\", xlab=\"Liczba obserwacji\", ylab=\"średnia\")\nabline(h=bcoin_mean)\n```\n\n##Centralne Twierdzenie Graniczne\n\nUogólnieniem prawa wielkich liczb jest centralne twierdzenie graniczne (CTG). Oprócz informacji na temat średniej z próby mamy infromacje na temat wariancji tej średniej próby. To jednak nie wszystko, wraz ze wzrostem liczebności próby, średnia z próby ma w przybliżeniu rozkład normalny. \nJest to bardzo ważna i użyteczna własność, która pozwala w łatwy sposób badać własności średniej. Jeżeli obserwujemy wiele niezależnych obserwacji zmiennej losowej o tym samym rozkładzie i interesuje nas jedynie średni (bądź sumaryczny) wynik, dzięki CTG musimy uzyc własności rokładu normalnego, który jest rozkładem bardzo łatwym do analizy.\n\nNależy byc jednak dość uważnym przy korzystaniu z CTG, ponieważ w przypadku małej liczebności próby rozkład średniej może być daleki od normalnego. Pod poniższymy linkami znjadują się proste aplikacje ilustrujące działanie CTG. \n\nDla rozkładu normalnego, CTG działa idealnie, ponieważ suma (i co za tym idzie średnia) zmiennych z rozkładem normalnym ma rozkład normalne. [link](https://amachno.shinyapps.io/CTG_norm)\n\nRozkład Poissona jest rozkładem dyskretnym, a więc na pierwszy rzut oka może sie wydawać zaskakujące, że średnia z obserwacji z rozkładu Poissona może mieć rozkład normalny. Dla odpowiedniej długości próby CTG działa satysfakcjonująco. [link](https://amachno.shinyapps.io/CLT_poisson)\n\nRozkład Bernulliego (rzut monetą) jest szczególnie interesujący. Po pierwsze zmienna o rozkładzie Bernulliego może przyjąc tylko dwie wartości (0,1) co czyni CTG nawet bardziej zaskakującym niz w przypadku rozkładu Poissona. Po drugie zmieniając prawdopodobieństwa na mniej symetryczne możemy zaobserwować jak bardzo trzeba byc uważnym przy korzystaniu z CTG. [link](https://amachno.shinyapps.io/CLT_coin)",
    "created" : 1443782940113.000,
    "dirty" : false,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "2537658952",
    "id" : "7B0851B6",
    "lastKnownWriteTime" : 1444420655,
    "path" : "C:/Users/Artur/Dropbox/AGH/dydaktyka/statystyka ZiP/2015-2016/R/R_functions_CLT.Rmd",
    "project_path" : "R_functions_CLT.Rmd",
    "properties" : {
        "tempName" : "Untitled1"
    },
    "relative_order" : 3,
    "source_on_save" : false,
    "type" : "r_markdown"
}