{
    "contents" : "---\ntitle: \"Przedziały ufności w R\"\nauthor: \"A. M. Machno\"\ndate: \"6 października 2015\"\noutput: html_document\n---\n\n##Normalne przedziały ufności dla wartości oczekiwanej\n\nDla zmiennej $X$ o rozkładzie normalnym ze znaną dystrybuantą $F$, jej realizacja leży w danym przedziale $(a,b)$ z prawdopodobieńtwem $F(b)-F(a)$. \n\nZatem, jezeli rozkład średniej z próby prostej jest w przybliżeniu normlany (CTG) to znając wariancję jej rozkładu (chodzi o wariancję średniej!) możemy zbudować przedział ufności dla wartości oczekiwanej. \n\nWeżmy zatem dane spalania z danych `mtcars` i zbudujmy przedziały ufności dla wartości oczekiwanej. Zakładamy, że odchylenie standardowe jest znane i jest równe odchyleniu z próby. \n\n```{r}\ndata(\"mtcars\")\n\n\n#średnia z próby\nmu<-mean(mtcars$mpg)\n#odchylenie standardowe\nsigma<-sd(mtcars$mpg)\n```\n\nZatem 90% przedział ufności to:\n```{r}\nround(mu+c(-1,1)*sigma/sqrt(32)*qnorm(.95),2)\n```\n\n95% przedział ufności to:\n```{r}\nround(mu+c(-1,1)*sigma/sqrt(32)*qnorm(.975),2)\n```\n\n99% przedział ufności to:\n```{r}\nround(mu+c(-1,1)*sigma/sqrt(32)*qnorm(.995),2)\n```\n\n**Ważne**: interpretacja otrzymanych wyników jest następująca: jeżeli dane 32 samochodów w zbiorze `mtcars` są reprezentatywne dla pewnej populacji to średnie spalanie w tej populacji na 90% jest w przedziale (18.34,21.84), przy założeniu, że.\n\n##T przedziały ufności\n\nDla niedostatecznej ilości obserwacji przybliżenie rozkładem normalnym jest nieodpowiednie. Ciężko podać konkretną liczbę obserwacji, dla której przyblizenie jest odpowiednie. Jak widzieliśmy w przykładach na działanie CTG, ta liczba jest różna dla różnych rozkładów. \nJeżeli mamy dostęp do odpowiedniego oprogramowania, zawsze bezppieczniej jest użyć rozkładu *t* w budowaniu przedziałóW ufności.\n\nPraktycznie zastępujemy odpowiedni kwantyl rozkładu normlanego kwantylem rozkładu *t*-Gosseta z *n-1* stopniami swobody, gdzie *n* to liczba obserwacji w próbie. Powtórzmy konstrukcję przedziałóW ufności dla spalania, tym razem z przedziałem *t*.\n\nZatem 90% przedział ufności to:\n```{r}\nround(mu+c(-1,1)*sigma/sqrt(32)*qt(.95, 31),2)\n```\n\n95% przedział ufności to:\n```{r}\nround(mu+c(-1,1)*sigma/sqrt(32)*qt(.975, 31),2)\n```\n\n99% przedział ufności to:\n```{r}\nround(mu+c(-1,1)*sigma/sqrt(32)*qt(.995, 31),2)\n```\n\nWidzimy, że wyniki sa bardzo zbliżone, różnice są mniejsze niż 0.1 dla większości krańców przedziałów. Dzieje się tak dlatego, że liczba obserwacji 32 jest dość duża i rozkład *t* z 31 stopniami swobody nienznacznie różni się od rozkładu normlanego.\n\nZobaczmy teraz co by się stało gdybyśmy mieli tylko 5 obserwacji.\n\n```{r}\n#losujemy 5 obserwacji z danych\nset.seed(21)\nmpg.5<-sample(mtcars$mpg, 5)\n\n#średnia z próby\nmu<-mean(mpg.5)\n#odchylenie standardowe\nsigma<-sd(mpg.5)\n```\n\nZatem 90% normalny przedział ufności to:\n```{r}\nround(mu+c(-1,1)*sigma/sqrt(5)*qnorm(.95),2)\n```\n\n95% normalny przedział ufności to:\n```{r}\nround(mu+c(-1,1)*sigma/sqrt(5)*qnorm(.975),2)\n```\n\n99% normalny przedział ufności to:\n```{r}\nround(mu+c(-1,1)*sigma/sqrt(5)*qnorm(.995),2)\n```\n\nZatem 90% przedział ufności *t* to:\n```{r}\nround(mu+c(-1,1)*sigma/sqrt(5)*qt(.95, 4),2)\n```\n\n95% przedział ufności *t* to:\n```{r}\nround(mu+c(-1,1)*sigma/sqrt(5)*qt(.975, 4),2)\n```\n\n99% przedział ufności *t* to:\n```{r}\nround(mu+c(-1,1)*sigma/sqrt(5)*qt(.995, 4),2)\n```\n\nWidzimy, że przedziały z rozkładem *t* są znacznie szersze. \n\n**Ważne**: w konstrukcji przedziałów ufności *t* nie korzystamy z CTG, te przedziały są poprawne tylko jeżeli rozkład zmiennych jest normalny (z nieznaną średnią i odchyleniem standardowym). W praktyce korzysta się jednak z tych przedziałów nawet jeżeli rozkłady nie są normalne, a inne techniki są niedostępne. \n\n##Przedział ufności dla wariancji\n\nPrzy założeniu normlaności rozkładu (tutaj też często w praktyce pomija się to założenie) wariancja ma zmodyfikowany rozkład $\\chi^2$. W łatwy sposób konstruujemy przedziały ufności dla wariancji:\n\n```{r}\ndata(\"mtcars\")\n\n\n#średnia z próby\nmu<-mean(mtcars$mpg)\n#odchylenie standardowe\nsigma<-sd(mtcars$mpg)\n```\n\nZatem 90% przedział ufności dla odchylenia standardowego to:\n```{r}\nround(sqrt(sigma*32/qchisq(c(1-.05,.05), 31)),2)\n```\n\n95% przedział ufności dla odchylenia standardowego to:\n```{r}\nround(sqrt(sigma*32/qchisq(c(1-.025,.025), 31)),2)\n```\n\n99% przedział ufności dla odchylenia standardowego to:\n```{r}\nround(sqrt(sigma*32/qchisq(c(1-.005,.005), 31)),2)\n```\n\nJako, że wariancja jest ograniczona z dołu (jest nieujemna) to nieraz może nas interesować największa wartość wariancji (odchylenia standardowego) z jakimś prawdopodobieństwem. Analizując dalej ten sam przykład, odchylenie standardowe na 90% nie przekracza:\n\n```{r}\nround(sqrt(sigma*32/qchisq(.1, 31)),2)\n```\n",
    "created" : 1444126501287.000,
    "dirty" : false,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "470705687",
    "id" : "DB3F3D3B",
    "lastKnownWriteTime" : 1444133963,
    "path" : "C:/Users/Artur/Dropbox/AGH/dydaktyka/statystyka ZiP/2015-2016/R/R_CI.Rmd",
    "project_path" : "R_CI.Rmd",
    "properties" : {
        "tempName" : "Untitled1"
    },
    "relative_order" : 4,
    "source_on_save" : false,
    "type" : "r_markdown"
}